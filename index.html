<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Casa Franchi - Tu Ferreter√≠a Online</title>
  <!-- Bootstrap CSS y Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="index.css">
</head>
<body>

  <!-- NAVBAR ESTILO MERCADO LIBRE -->
  <nav class="navbar navbar-expand-lg shadow-sm" style="background-color: #ffe600;">
    <div class="container align-items-center">
      <a class="navbar-brand d-flex align-items-center" href="/index.html">
        <img src="./logo4.png" alt="Logo" style="height: 75px;">
      </a>
      <form class="d-flex flex-grow-1 mx-3 position-relative">
        <input id="searchInput" class="form-control rounded-start border-0 shadow-sm" type="search" placeholder="Buscar productos, marcas y m√°s..." aria-label="Search" autocomplete="off">
        <button class="btn btn-light border-start-0 rounded-end" type="submit"><i class="bi bi-search"></i></button>
        <div id="searchResults" class="position-absolute bg-white shadow rounded mt-1 w-100 z-3 d-none" style="top: 100%; max-height: 300px; overflow-y: auto;"></div>
      </form>

      <div class="d-flex align-items-center gap-3">
        <a href="#" class="text-dark fw-semibold text-decoration-none">Categor√≠as</a>
        <a href="#" class="text-dark"><i class="bi bi-person fs-5"></i></a>
        <a href="#" class="text-dark"><i class="bi bi-cart fs-5"></i></a>
      </div>
    </div>
  </nav>


  <!-- HERO SLIDER -->
  <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active position-relative">
        <img src="https://www.lusqtoff.com.ar/2023/uploads/Categorias/SOLDADORAS%20(1).jpg" class="d-block w-100 hero-carousel">
        <div class="hero-caption">
          <h1>Las Mejores Herramientas</h1>
          <p><strong> En Casa Franchi encontr√°s calidad, precio y env√≠o r√°pido.</strong></p>
          <a href="#productos" class="btn btn-primary">Ver Productos</a>
        </div>
      </div>
      <div class="carousel-item position-relative">
        <img src="https://res-de.togroup.com/stc/website-center/files/upload/common/source/HOME_PAGE_BANNER/8_wadfow/2.jpg"
             class="d-block w-100 hero-carousel">
        <div class="hero-caption">
          <h1>Herramientas a Bater√≠a</h1>
          <p>Libertad de movimiento y potencia sin cables.</p>
          <a href="#productos" class="btn btn-primary">Descubr√≠</a>
        </div>
      </div>
      <div class="carousel-item position-relative">
        <img src="https://lacasadelcarpintero.com.ar/wp-content/uploads/2023/09/bosch_tools.jpg"
             class="d-block w-100 hero-carousel">
        <div class="hero-caption">
          <h1>Potencia Industrial</h1>
          <p>Las mejores marcas profesionales en un solo lugar.</p>
          <a href="#marcas" class="btn btn-primary">Ver Marcas</a>
        </div>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>

  <!-- BENEFICIOS -->
  <section id="beneficios">
    <div class="container">
      <div class="row gx-5 text-center">
        <div class="col-md-4 mb-4">
          <div class="d-flex justify-content-center align-items-center">
            <i class="bi bi-credit-card icon"></i>
            <div>
              <h5>6 cuotas sin inter√©s</h5>
              <small>Con todas las tarjetas</small>
            </div>
          </div>
        </div>
        <div class="col-md-4 mb-4">
          <div class="d-flex justify-content-center align-items-center">
            <i class="bi bi-truck icon"></i>
            <div>
              <h5>Env√≠os gratis</h5>
              <small>Compras mayores a $50.000</small>
            </div>
          </div>
        </div>
        <div class="col-md-4 mb-4">
          <div class="d-flex justify-content-center align-items-center">
            <i class="bi bi-shield-check icon"></i>
            <div>
              <h5>Compra segura</h5>
              <small>Protecci√≥n total</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
 <section class="ofertas-relampago py-5 px-3">
  <div class="text-center mb-4">
    <h2 class="titulo-relampago">üî• OFERTAS REL√ÅMPAGO DE LA SEMANA üî•</h2>
    <div class="mt-2">
      <small id="reloj-oferta" class="fw-bold text-light" style="font-size: 1.1rem;"></small>
    </div>
  </div>
  <div class="row" id="ofertas-relampago-container"></div>
</section>

<style>
  .ofertas-relampago {
  background: linear-gradient(to right, #ff0000, #660000);
  border-top: 5px solid yellow;
  border-bottom: 5px solid yellow;
  color: white;
}

.titulo-relampago {
  color: #fff700;
  font-weight: bold;
  text-shadow: 2px 2px 0 #000;
}

.card-relampago {
  background: white;
  border: 3px solid red;
  box-shadow: 0 0 10px red;
  transition: transform 0.2s ease;
}

.card-relampago:hover {
  transform: scale(1.03);
}

.card-relampago img {
  object-fit: cover;
  height: 400px;
}

</style>


  <!-- COMBOS EXCLUSIVOS -->
<section id="combos" class="container my-5">
  <h2 class="section-title text-center mb-4">Combos Exclusivos</h2>
  <div class="row" id="combos-grid"></div>
  <!-- VER M√ÅS COMBOS -->
  <div class="text-center mt-5 mb-4">
    <a href="combos.html" class="combo-link d-inline-block text-decoration-none">
      <div class="combo-btn d-flex align-items-center justify-content-center mx-auto mb-2">
        <i class="bi bi-tools fs-3 text-dark"></i>
      </div>
      <div class="text-dark fw-semibold">Ver m√°s combos</div>
    </a>
  </div>
</section>


    <!-- PRODUCTOS SCROLL -->
  <section id="productos" class="container my-5">
    <h2 class="section-title">Nuestros Productos</h2>
    <div class="row" id="productos-grid"></div>
    <div class="text-center mt-4">
      <button id="btn-ver-mas" class="btn btn-outline-primary"> Ver m√°s productos</button>
    </div>
  </section>
  <style>
    /* === COMBOS EXCLUSIVOS ESTILO M√ÅS GRANDE === */
#combos .card {
  border-radius: 16px;
  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease;
  padding: 16px;
  min-height: 100%;
}

#combos .card:hover {
  transform: scale(1.03);
}

#combos .card img {
  max-height: 260px;
  object-fit: contain;
  margin-bottom: 12px;
}

#combos .card-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: #000;
  text-align: center;
}

#combos .card-text {
  font-size: 1rem;
  color: #444;
  text-align: center;
}

#combos .price {
  font-size: 1.8rem;
  font-weight: bold;
  color: #0400ff;
  text-align: center;
  margin: 12px 0;
}

#combos .beneficios {
  text-align: center;
  font-size: 0.95rem;
  color: #dc3545;
  font-weight: 500;
}

#combos .btn-comprar-ahora {
  background: #ffee00;
  color: #000;
  font-size: 1.1rem;
  font-weight: 700;
  padding: 12px;
  margin-top: 1rem;
  border: none;
  transition: background 0.3s ease;
}

#combos .btn-comprar-ahora:hover {
  background: #fff000;
}

  </style>

  




<style>
  .producto-card {
    transition: box-shadow 0.3s ease;
  }
  .producto-card:hover {
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  }
  /* === CARRUSEL CIRCULAR (mant√©n las variables de tu CSS principal) === */
  .top-products-wrapper { overflow: hidden; }
  .top-products-list {
    display: flex;
    gap: 1.5rem;
    padding: 0 3rem;
    scroll-behavior: smooth;
    overflow-x: hidden;
  }
  .tp-btn {
    position: absolute; top:50%; transform:translateY(-50%);
    z-index:2; width:3rem; height:3rem; border:none;
    border-radius:50%; background:var(--clr-primary); color:#fff;
    font-size:1.5rem; cursor:pointer;
    transition:background .3s;
  }
  .tp-btn:hover { background: #d04f1f; }
  .prev { left:1rem; } .next { right:1rem; }

  .product-circle {
    flex:0 0 auto; width:180px; height:180px;
    border-radius:50%; overflow:hidden; background:#fff;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
    transition:transform .3s, box-shadow .3s;
    position:relative; cursor:pointer;
  }
  .product-circle img {
    width:100%; height:100%; object-fit:cover;
  }
  .product-circle:hover {
    transform:scale(1.1);
    box-shadow:0 8px 24px rgba(0,0,0,0.2);
  }
  .product-circle .info {
    position:absolute; bottom:0; width:100%;
    background:rgba(0,0,0,0.6); color:#fff;
    text-align:center; padding:.4rem .2rem;
    font-size:.9rem; opacity:0;
    transition:opacity .3s;
  }
  .product-circle:hover .info { opacity:1; }

  @media (max-width:768px) {
    .tp-btn { display:none; }
    .top-products-list { overflow-x:auto; padding:0 1rem; }
  }
</style>

<script>
  // ================================
  // Suponemos que ya inicializaste Firebase antes
  // ================================
  
</script>


  <!-- FOOTER -->
  <footer id="contacto">
    <div class="container text-center">
      <div class="row gy-3">
        <div class="col-md-4">
          <h5>Casa Franchi</h5>
          <small>Distribuidor oficial de herramientas profesionales en Argentina.</small>
        </div>
        <div class="col-md-4">
          <h5>Contacto</h5>
          <small>üìû 11 2498-9866<br>üìß ariel@casafranchi.com.ar</small>
        </div>
      </div>
      <small class="d-block mt-3">&copy; 2025 Casa Franchi. Todos los derechos reservados.</small>
    </div>
  </footer>

  <!-- Firebase + Firestore + Poblado de productos -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDw-4Tm4FgNPhAHEbvcrjFXICzU3lXGD_g",
    authDomain: "casafranchi-ff656.firebaseapp.com",
    projectId: "casafranchi-ff656",
    storageBucket: "casafranchi-ff656.appspot.com",
    messagingSenderId: "336476209274",
    appId: "1:336476209274:web:fba9994666d0656817bc3",
    measurementId: "G-NZMERBW9EQ"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const contenedor = document.getElementById('productos-grid');
  const btnVerMas = document.getElementById('btn-ver-mas');
  const searchInput = document.getElementById('searchInput');
  const searchResults = document.getElementById('searchResults');

  let productos = [];
  let cantidadMostrada = 0;
  const productosPorBloque = 200;

  // Renderiza productos en el contenedor
  function renderProductos() {
    const productosAMostrar = productos.slice(cantidadMostrada, cantidadMostrada + productosPorBloque);

    productosAMostrar.forEach((d, i) => {
      if (!d.imagen1_base64 || d.imagen1_base64.trim() === '') return;
      const idx = cantidadMostrada + i;
      const div = document.createElement('div');
      div.className = "product-col mb-4";
      div.innerHTML = `
        <div class="card producto-card mb-4" data-index="${idx}">
          <img src="data:image/jpeg;base64,${d.imagen1_base64}" class="card-img-top js-ver-detalle" alt="${d.producto}" style="cursor:pointer;">
          <div class="card-body">
            <h5 class="card-title">${d.producto}</h5>
            <p class="card-text">${d.caracteristica || ''}</p>
            <div class="price">$${Math.round(d.cem).toLocaleString()}</div>
            <div class="beneficios">Envio gratis + 6 c/ sin interes + Descuento en transferencia</div>
            <button class="btn btn-primary btn-comprar-ahora w-100 mt-3">Comprar ahora</button>
            <button class="btn btn-outline-primary btn-agregar-carrito w-100 mt-2">Agregar al carrito</button>
          </div>
        </div>`;
      contenedor.appendChild(div);
    });

    cantidadMostrada += productosAMostrar.length;
    if (cantidadMostrada >= productos.length) btnVerMas.style.display = 'none';

    setListeners();
  }

  function renderOfertasRelampago() {
  const contenedor = document.getElementById("ofertas-relampago-container");
  if (!contenedor) return;

  const ofertas = productos.filter(p => p.codigo?.toUpperCase().includes("OFERTA24"));
  if (ofertas.length === 0) return;

  contenedor.innerHTML = "";

  ofertas.forEach((p, i) => {
    const idx = productos.findIndex(prod => prod.id === p.id); // buscamos el √≠ndice real
    contenedor.innerHTML += `
      <div class="col-md-4 mb-4">
        <div class="card card-relampago h-100 producto-card" data-index="${idx}">
          <img src="data:image/jpeg;base64,${p.imagen1_base64}" class="card-img-top js-ver-detalle" alt="${p.producto}" style="cursor:pointer;">
          <div class="card-body">
            <h5 class="card-title text-dark fw-bold">${p.producto}</h5>
            <p class="card-text text-danger fw-bold fs-5">$${p.cem}</p>
            <div class="beneficios">üî• Ofertas √∫nicas ‚Ä¢ 6 cuotas sin inter√©s</div>
            <button class="btn btn-primary btn-comprar-ahora w-100 mt-3">Comprar ahora</button>
            <button class="btn btn-outline-primary btn-agregar-carrito w-100 mt-2">Agregar al carrito</button>
          </div>
        </div>
      </div>
    `;
  });

  setListeners(); // para que se activen los clics
}


function iniciarCuentaRegresiva() {
  const reloj = document.getElementById("reloj-oferta");
  if (!reloj) return;

  const ahora = new Date();
  const finDelDia = new Date();
  finDelDia.setHours(23, 59, 59, 999);

  const intervalo = setInterval(() => {
    const diferencia = finDelDia - new Date();
    if (diferencia <= 0) {
      clearInterval(intervalo);
      reloj.textContent = "‚è≥ Oferta expirada";
      return;
    }

    const h = Math.floor(diferencia / (1000 * 60 * 60));
    const m = Math.floor((diferencia / (1000 * 60)) % 60);
    const s = Math.floor((diferencia / 1000) % 60);
    reloj.textContent = `‚è∞ Tiempo restante: ${h}h ${m}m ${s}s`;
  }, 1000);
}

iniciarCuentaRegresiva();

  // Listeners de botones y productos
  function setListeners() {
    document.querySelectorAll('.js-ver-detalle').forEach(img => {
      img.addEventListener('click', e => {
        const idx = e.target.closest('.producto-card').dataset.index;
        const producto = productos[idx];
        window.location.href = `detalleproducto.html?id=${producto.id}`;
      });
    });

    document.querySelector('form button[type="submit"]').addEventListener('click', e => {
      e.preventDefault();
      const search = searchInput.value.trim();
      if (search !== '') {
        window.location.href = `productosfiltrados.html?query=${encodeURIComponent(search)}`;
      }
    });

    document.querySelectorAll('.btn-comprar-ahora').forEach(btn => {
      btn.addEventListener('click', e => {
        const idx = e.target.closest('.producto-card').dataset.index;
        const producto = productos[idx];
        localStorage.setItem('detalleProducto', JSON.stringify(producto));
        window.location.href = `detalleproducto.html?id=${producto.id}`;
      });
    });

    document.querySelectorAll('.btn-agregar-carrito').forEach(btn => {
      btn.addEventListener('click', e => {
        const idx = e.target.closest('.producto-card').dataset.index;
        const producto = productos[idx];
        const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
        carrito.push(producto);
        localStorage.setItem('carrito', JSON.stringify(carrito));
        alert(`"${producto.producto}" agregado al carrito.`);
        actualizarContadorCarrito?.();
      });
    });
  }

  // Buscar en la lista de productos local
  let resultadosBusquedaActual = [];

  searchInput.addEventListener('input', () => {
    const search = searchInput.value.toLowerCase();
    if (search === '') {
      resultadosBusquedaActual = [];
      searchResults.classList.add('d-none');
      return;
    }

    resultadosBusquedaActual = productos.filter(prod =>
      prod.producto.toLowerCase().includes(search) ||
      prod.marca?.toLowerCase().includes(search) ||
      prod.caracteristica?.toLowerCase().includes(search)
    );

    renderSearchResults(resultadosBusquedaActual);
  });

  searchInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      e.preventDefault(); // evita env√≠o del form
      const search = searchInput.value.trim();
      if (search !== '') {
        window.location.href = `productosfiltrados.html?query=${encodeURIComponent(search)}`;
      }
    }
  });
  // Secci√≥n OFERTAS REL√ÅMPAGO
    const contenedorOfertas = document.getElementById('contenedorOfertas');

    const ofertasRelampago = productos.filter(p =>
      (p.producto?.toLowerCase().includes("oferta24") ||
      p.caracteristica?.toLowerCase().includes("oferta24"))
    );

    // Mostrar m√°ximo 4 al azar
    const ofertasMostradas = ofertasRelampago.sort(() => 0.5 - Math.random()).slice(0, 4);

    ofertasMostradas.forEach(oferta => {
      const div = document.createElement('div');
      div.className = 'col-md-3';
      div.innerHTML = `
        <div class="card card-fuego h-100 text-center">
          <img src="data:image/jpeg;base64,${oferta.imagen1_base64}" class="card-img-top p-2" alt="${oferta.producto}" style="height: 200px; object-fit: contain;">
          <div class="card-body">
            <h5 class="card-title">${oferta.producto}</h5>
            <p class="text-white small">${oferta.caracteristica || ''}</p>
            <div class="price mb-2">$${Math.round(oferta.csi_cem).toLocaleString()}</div>
            <a href="detalleproducto.html?id=${oferta.id}" class="btn btn-sm btn-light fw-bold">VER PRODUCTO</a>
          </div>
        </div>
      `;
      contenedorOfertas.appendChild(div);
    });



  function renderProductosMasVendidos() {
  const masVendidos = productos.filter(p => p.mas_vendido); // filtra los m√°s vendidos
  const grid = document.getElementById('mas-vendidos-grid');

  masVendidos.forEach((d, i) => {
    const div = document.createElement('div');
    div.className = "col-md-4 mb-4";
    div.innerHTML = `
      <div class="card producto-card" data-index="${i}">
        <span class="badge-top">üî• M√ÅS VENDIDO</span>
        <img src="data:image/jpeg;base64,${d.imagen1_base64}" class="card-img-top js-ver-detalle" alt="${d.producto}" style="cursor:pointer;">
        <div class="card-body">
          <h5 class="card-title">${d.producto}</h5>
          <p class="card-text">${d.caracteristica || ''}</p>
          <div class="price fw-bold text-primary fs-5">$${Math.round(d.csi_cem).toLocaleString()}</div>
          <button class="btn btn-primary btn-comprar-ahora w-100 mt-3">Comprar ahora</button>
          <button class="btn btn-outline-primary btn-agregar-carrito w-100 mt-2">Agregar al carrito</button>
        </div>
      </div>
    `;
    grid.appendChild(div);
  });

  setListeners();
}

  // Mostrar combos autom√°ticamente
function renderCombos() {
  const gridCombos = document.getElementById('combos-grid');
  let combos = productos.filter(p => p.producto.toLowerCase().includes('combo'));

  // Mezclar aleatoriamente los combos y tomar solo 2
  combos = combos.sort(() => 0.5 - Math.random()).slice(0, 2);

  combos.forEach((d, i) => {
    if (!d.imagen1_base64 || d.imagen1_base64.length < 50) return;

    const div = document.createElement('div');
    div.className = "col-md-6 mb-4"; // solo 2 columnas
    div.innerHTML = `
      <div class="card producto-card h-100" data-index="${i}">
        <img src="data:image/jpeg;base64,${d.imagen1_base64}" class="card-img-top js-ver-detalle" alt="${d.producto}" style="cursor:pointer;">
        <div class="card-body">
          <h5 class="card-title">${d.producto}</h5>
          <p class="card-text">${d.caracteristica || ''}</p>
          <div class="price">$${Math.round(d.cem).toLocaleString()}</div>
          <div class="beneficios">üî• Combos √∫nicos ‚Ä¢ Env√≠o gratis ‚Ä¢ 6 cuotas sin inter√©s</div>
          <button class="btn btn-primary btn-comprar-ahora w-100 mt-3">Comprar ahora</button>
        </div>
      </div>
    `;
    gridCombos.appendChild(div);
  });

  setListeners();
}



  function renderSearchResults(productosFiltrados) {
  searchResults.innerHTML = '';
  if (productosFiltrados.length === 0) {
    searchResults.classList.add('d-none');
    return;
  }

  productosFiltrados.slice(0, 10).forEach(prod => {
    const div = document.createElement('div');
    div.className = 'search-item';
    div.onclick = () => {
      window.location.href = `detalleproducto.html?id=${prod.id}`;
    };
    div.innerHTML = `
      <img src="data:image/jpeg;base64,${prod.imagen1_base64}" alt="${prod.producto}">
      <div class="search-item-info">
        <h6>${prod.producto}</h6>
        <div class="price">$${Math.round(prod.csi_cem).toLocaleString()}</div>
      </div>`;
    searchResults.appendChild(div);
  });

  searchResults.classList.remove('d-none');
}



  // Cargar productos al inicio
  db.collection("productos").get().then(snapshot => {
    productos = [];
    snapshot.forEach(doc => productos.push({ id: doc.id, ...doc.data() }));
    renderProductos();
    renderProductosMasVendidos();
    renderCombos();
    renderOfertasRelampago();
  });

  btnVerMas.addEventListener('click', renderProductos);
</script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


  <!-- Bot√≥n flotante del carrito -->
  <div id="carrito-flotante">
    <i class="bi bi-cart3"></i>
    <span id="contador-carrito">0</span>
  </div>

  <!-- Panel lateral del carrito -->
  <div id="panel-carrito">
    <div class="carrito-header">
      <h5>üõí Tu Carrito</h5>
      <button id="cerrar-carrito" class="btn-close"></button>
    </div>
    <div id="contenido-carrito" class="carrito-items"></div>
    <div class="carrito-total">
      <strong>Total: $<span id="carrito-total">0</span></strong>
    </div>
  </div>
  <style>
    #carrito-flotante {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: rgb(255, 238, 0);
        color: black;
        border-radius: 50px;
        padding: 12px 16px;
        cursor: pointer;
        z-index: 9999;
        display: flex;
        align-items: center;
        font-size: 22px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      }
      #carrito-flotante span {
        margin-left: 8px;
        background: black;
        color: white;
        padding: 2px 8px;
        border-radius: 50px;
        font-size: 14px;
      }

      #panel-carrito {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100%;
        background: white;
        box-shadow: -2px 0 10px rgba(0,0,0,0.2);
        transition: right 0.3s ease-in-out;
        z-index: 10000;
        padding: 20px;
        display: flex;
        flex-direction: column;
      }

      #panel-carrito.open {
        right: 0;
      }

      .carrito-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .carrito-items {
        flex: 1;
        overflow-y: auto;
        margin-top: 20px;
      }

      .carrito-item {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        border-bottom: 1px solid #ddd;
        padding-bottom: 12px;
        gap: 10px;
      }

      .carrito-item img {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 8px;
        border: 2px solid #0400ff;
      }

      .carrito-detalle {
        flex: 1;
      }

      .producto-nombre {
        font-weight: 600;
        font-size: 16px;
        color: #333;
        margin-bottom: 5px;
      }

      .producto-precio {
        font-size: 15px;
        color: #0400ff;
      }

      .btn-eliminar {
        background: transparent;
        border: none;
        color: #0400ff;
        font-size: 18px;
        cursor: pointer;
        font-weight: bold;
        padding: 0 8px;
        transition: color 0.2s ease;
      }

      .btn-eliminar:hover {
        color: #ffee00;
      }

      .btn-finalizar-compra {
        display: block;
        margin-top: 25px;
        background-color: #0400ff;
        color: white;
        padding: 12px;
        text-align: center;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        transition: background 0.3s ease;
      }

      .btn-finalizar-compra:hover {
        background-color: #3d39ff;
      } 

      .carrito-vacio {
        text-align: center;
        color: #666;
        margin-top: 30px;
        font-style: italic;
      }
  </style>
  
  <script>
  function actualizarContadorCarrito() {
    const cart = JSON.parse(localStorage.getItem('carrito') || '[]');
    document.getElementById('contador-carrito').textContent = cart.length;
  }

  function actualizarContadorCarrito() {
  const cart = JSON.parse(localStorage.getItem('carrito') || '[]');
  document.getElementById('contador-carrito').textContent = cart.length;
}

function eliminarProducto(index) {
  const cart = JSON.parse(localStorage.getItem('carrito') || '[]');
  cart.splice(index, 1); // elimina por √≠ndice
  localStorage.setItem('carrito', JSON.stringify(cart));
  renderizarCarrito();
  actualizarContadorCarrito();
}

function renderizarCarrito() {
  const cart = JSON.parse(localStorage.getItem('carrito') || '[]');
  const contenedor = document.getElementById('contenido-carrito');
  const totalSpan = document.getElementById('carrito-total');
  contenedor.innerHTML = '';
  let total = 0;

  cart.forEach((item, index) => {
    const precio = parseFloat(item.csi_cem || 0);
    total += precio;

    const imagenBase64 = item.imagen1_base64 || '';
    const imagenSrc = imagenBase64.length > 100
      ? `data:image/jpeg;base64,${imagenBase64}`
      : 'https://via.placeholder.com/60x60.png?text=Sin+Imagen';

    const div = document.createElement('div');
    div.className = 'carrito-item';
    div.innerHTML = `
      <img src="${imagenSrc}" alt="Producto">
      <div class="carrito-detalle">
        <div class="producto-nombre">${item.producto}</div>
        <div class="producto-precio">$${precio.toFixed(2)}</div>
      </div>
      <button class="btn-eliminar" onclick="eliminarProducto(${index})">‚úï</button>
    `;
    contenedor.appendChild(div);
  });

  totalSpan.textContent = total.toFixed(2);

  if (cart.length > 0) {
    const botonFinalizar = document.createElement('a');
    botonFinalizar.href = 'finalizarcompra.html';
    botonFinalizar.className = 'btn-finalizar-compra';
    botonFinalizar.innerText = 'Finalizar compra ';
    contenedor.appendChild(botonFinalizar);
  } else {
    contenedor.innerHTML = '<p class="carrito-vacio">üõí Tu carrito est√° vac√≠o</p>';
  }
}



  document.getElementById('carrito-flotante').addEventListener('click', () => {
    document.getElementById('panel-carrito').classList.add('open');
    renderizarCarrito();
  });

  document.getElementById('cerrar-carrito').addEventListener('click', () => {
    document.getElementById('panel-carrito').classList.remove('open');
  });

  actualizarContadorCarrito();
</script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">


</body>
</html>
